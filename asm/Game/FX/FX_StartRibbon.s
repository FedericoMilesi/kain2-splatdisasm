.set noat      /* allow manual use of $at */
.set noreorder /* don't insert nops after branches */

glabel FX_StartRibbon
/* 37DA0 800475A0 C0FFBD27 */  addiu      $sp, $sp, -0x40
/* 37DA4 800475A4 3400B7AF */  sw         $s7, 0x34($sp)
/* 37DA8 800475A8 21B88000 */  addu       $s7, $a0, $zero
/* 37DAC 800475AC 2000B2AF */  sw         $s2, 0x20($sp)
/* 37DB0 800475B0 2190E000 */  addu       $s2, $a3, $zero
/* 37DB4 800475B4 2400B3AF */  sw         $s3, 0x24($sp)
/* 37DB8 800475B8 2198A000 */  addu       $s3, $a1, $zero
/* 37DBC 800475BC 3800BEAF */  sw         $fp, 0x38($sp)
/* 37DC0 800475C0 21F04002 */  addu       $fp, $s2, $zero
/* 37DC4 800475C4 1000A6A7 */  sh         $a2, 0x10($sp)
/* 37DC8 800475C8 00340600 */  sll        $a2, $a2, 16
/* 37DCC 800475CC 03340600 */  sra        $a2, $a2, 16
/* 37DD0 800475D0 002C0500 */  sll        $a1, $a1, 16
/* 37DD4 800475D4 3000B6AF */  sw         $s6, 0x30($sp)
/* 37DD8 800475D8 5000B697 */  lhu        $s6, 0x50($sp)
/* 37DDC 800475DC 032C0500 */  sra        $a1, $a1, 16
/* 37DE0 800475E0 2800B4AF */  sw         $s4, 0x28($sp)
/* 37DE4 800475E4 5400B497 */  lhu        $s4, 0x54($sp)
/* 37DE8 800475E8 2330C500 */  subu       $a2, $a2, $a1
/* 37DEC 800475EC 1C00B1AF */  sw         $s1, 0x1C($sp)
/* 37DF0 800475F0 0100D124 */  addiu      $s1, $a2, 0x1
/* 37DF4 800475F4 2C00B5AF */  sw         $s5, 0x2C($sp)
/* 37DF8 800475F8 5800B597 */  lhu        $s5, 0x58($sp)
/* 37DFC 800475FC 0200222A */  slti       $v0, $s1, 0x2
/* 37E00 80047600 3C00BFAF */  sw         $ra, 0x3C($sp)
/* 37E04 80047604 1B004014 */  bnez       $v0, .L80047674
/* 37E08 80047608 1800B0AF */   sw        $s0, 0x18($sp)
/* 37E0C 8004760C 2C000424 */  addiu      $a0, $zero, 0x2C
/* 37E10 80047610 8140010C */  jal        MEMPACK_Malloc
/* 37E14 80047614 0D000524 */   addiu     $a1, $zero, 0xD
/* 37E18 80047618 21804000 */  addu       $s0, $v0, $zero
/* 37E1C 8004761C 15000012 */  beqz       $s0, .L80047674
/* 37E20 80047620 0480023C */   lui       $v0, %hi(FX_ContinueRibbon)
/* 37E24 80047624 C87D4224 */  addiu      $v0, $v0, %lo(FX_ContinueRibbon)
/* 37E28 80047628 040002AE */  sw         $v0, 0x4($s0)
/* 37E2C 8004762C 00141200 */  sll        $v0, $s2, 16
/* 37E30 80047630 03140200 */  sra        $v0, $v0, 16
/* 37E34 80047634 01000324 */  addiu      $v1, $zero, 0x1
/* 37E38 80047638 0C0000A2 */  sb         $zero, 0xC($s0)
/* 37E3C 8004763C 03004314 */  bne        $v0, $v1, .L8004764C
/* 37E40 80047640 120000A6 */   sh        $zero, 0x12($s0)
/* 37E44 80047644 941D0108 */  j          .L80047650
/* 37E48 80047648 04107100 */   sllv      $v0, $s1, $v1
.L8004764C:
/* 37E4C 8004764C 04000224 */  addiu      $v0, $zero, 0x4
.L80047650:
/* 37E50 80047650 100002A6 */  sh         $v0, 0x10($s0)
/* 37E54 80047654 10000486 */  lh         $a0, 0x10($s0)
/* 37E58 80047658 0D000524 */  addiu      $a1, $zero, 0xD
/* 37E5C 8004765C 8140010C */  jal        MEMPACK_Malloc
/* 37E60 80047660 C0200400 */   sll       $a0, $a0, 3
/* 37E64 80047664 05004014 */  bnez       $v0, .L8004767C
/* 37E68 80047668 140002AE */   sw        $v0, 0x14($s0)
/* 37E6C 8004766C 2641010C */  jal        MEMPACK_Free
/* 37E70 80047670 21200002 */   addu      $a0, $s0, $zero
.L80047674:
/* 37E74 80047674 101E0108 */  j          .L80047840
/* 37E78 80047678 21100000 */   addu      $v0, $zero, $zero
.L8004767C:
/* 37E7C 8004767C 002C1400 */  sll        $a1, $s4, 16
/* 37E80 80047680 032C0500 */  sra        $a1, $a1, 16
/* 37E84 80047684 00100324 */  addiu      $v1, $zero, 0x1000
/* 37E88 80047688 1A006500 */  div        $zero, $v1, $a1
/* 37E8C 8004768C 12280000 */  mflo       $a1
/* 37E90 80047690 00141500 */  sll        $v0, $s5, 16
/* 37E94 80047694 03140200 */  sra        $v0, $v0, 16
/* 37E98 80047698 260014A6 */  sh         $s4, 0x26($s0)
/* 37E9C 8004769C 26000486 */  lh         $a0, 0x26($s0)
/* 37EA0 800476A0 23186200 */  subu       $v1, $v1, $v0
/* 37EA4 800476A4 1A006400 */  div        $zero, $v1, $a0
/* 37EA8 800476A8 12200000 */  mflo       $a0
/* 37EAC 800476AC 180013A6 */  sh         $s3, 0x18($s0)
/* 37EB0 800476B0 1000A897 */  lhu        $t0, 0x10($sp)
/* 37EB4 800476B4 080017AE */  sw         $s7, 0x8($s0)
/* 37EB8 800476B8 0D001EA2 */  sb         $fp, 0xD($s0)
/* 37EBC 800476BC 0E0016A6 */  sh         $s6, 0xE($s0)
/* 37EC0 800476C0 1A0008A6 */  sh         $t0, 0x1A($s0)
/* 37EC4 800476C4 5C00A28F */  lw         $v0, 0x5C($sp)
/* 37EC8 800476C8 00000000 */  nop
/* 37ECC 800476CC 1C0002AE */  sw         $v0, 0x1C($s0)
/* 37ED0 800476D0 6000A28F */  lw         $v0, 0x60($sp)
/* 37ED4 800476D4 FF00C333 */  andi       $v1, $fp, 0xFF
/* 37ED8 800476D8 280015A6 */  sh         $s5, 0x28($s0)
/* 37EDC 800476DC 200002AE */  sw         $v0, 0x20($s0)
/* 37EE0 800476E0 02000224 */  addiu      $v0, $zero, 0x2
/* 37EE4 800476E4 240005A6 */  sh         $a1, 0x24($s0)
/* 37EE8 800476E8 0B006214 */  bne        $v1, $v0, .L80047718
/* 37EEC 800476EC 2A0004A6 */   sh        $a0, 0x2A($s0)
/* 37EF0 800476F0 001C0400 */  sll        $v1, $a0, 16
/* 37EF4 800476F4 031C0300 */  sra        $v1, $v1, 16
/* 37EF8 800476F8 40100300 */  sll        $v0, $v1, 1
/* 37EFC 800476FC 21104300 */  addu       $v0, $v0, $v1
/* 37F00 80047700 40100200 */  sll        $v0, $v0, 1
/* 37F04 80047704 02004104 */  bgez       $v0, .L80047710
/* 37F08 80047708 00000000 */   nop
/* 37F0C 8004770C 07004224 */  addiu      $v0, $v0, 0x7
.L80047710:
/* 37F10 80047710 C3100200 */  sra        $v0, $v0, 3
/* 37F14 80047714 2A0002A6 */  sh         $v0, 0x2A($s0)
.L80047718:
/* 37F18 80047718 4000E48E */  lw         $a0, 0x40($s7)
/* 37F1C 8004771C 00000000 */  nop
/* 37F20 80047720 42008010 */  beqz       $a0, .L8004782C
/* 37F24 80047724 01000224 */   addiu     $v0, $zero, 0x1
/* 37F28 80047728 0D000392 */  lbu        $v1, 0xD($s0)
/* 37F2C 8004772C 00000000 */  nop
/* 37F30 80047730 1D006214 */  bne        $v1, $v0, .L800477A8
/* 37F34 80047734 00141300 */   sll       $v0, $s3, 16
/* 37F38 80047738 C3120200 */  sra        $v0, $v0, 11
/* 37F3C 8004773C 21208200 */  addu       $a0, $a0, $v0
/* 37F40 80047740 3C00201A */  blez       $s1, .L80047834
/* 37F44 80047744 21300000 */   addu      $a2, $zero, $zero
/* 37F48 80047748 1C008524 */  addiu      $a1, $a0, 0x1C
.L8004774C:
/* 37F4C 8004774C C0200600 */  sll        $a0, $a2, 3
/* 37F50 80047750 0100C624 */  addiu      $a2, $a2, 0x1
/* 37F54 80047754 1400028E */  lw         $v0, 0x14($s0)
/* 37F58 80047758 F8FFA394 */  lhu        $v1, -0x8($a1)
/* 37F5C 8004775C 21108200 */  addu       $v0, $a0, $v0
/* 37F60 80047760 000043A4 */  sh         $v1, 0x0($v0)
/* 37F64 80047764 1400028E */  lw         $v0, 0x14($s0)
/* 37F68 80047768 FCFFA394 */  lhu        $v1, -0x4($a1)
/* 37F6C 8004776C 21108200 */  addu       $v0, $a0, $v0
/* 37F70 80047770 020043A4 */  sh         $v1, 0x2($v0)
/* 37F74 80047774 1400028E */  lw         $v0, 0x14($s0)
/* 37F78 80047778 0000A394 */  lhu        $v1, 0x0($a1)
/* 37F7C 8004777C 21208200 */  addu       $a0, $a0, $v0
/* 37F80 80047780 040083A4 */  sh         $v1, 0x4($a0)
/* 37F84 80047784 12000296 */  lhu        $v0, 0x12($s0)
/* 37F88 80047788 00000000 */  nop
/* 37F8C 8004778C 01004224 */  addiu      $v0, $v0, 0x1
/* 37F90 80047790 120002A6 */  sh         $v0, 0x12($s0)
/* 37F94 80047794 2A10D100 */  slt        $v0, $a2, $s1
/* 37F98 80047798 ECFF4014 */  bnez       $v0, .L8004774C
/* 37F9C 8004779C 2000A524 */   addiu     $a1, $a1, 0x20
/* 37FA0 800477A0 0D1E0108 */  j          .L80047834
/* 37FA4 800477A4 00000000 */   nop
.L800477A8:
/* 37FA8 800477A8 C3120200 */  sra        $v0, $v0, 11
/* 37FAC 800477AC 21208200 */  addu       $a0, $a0, $v0
/* 37FB0 800477B0 1400038E */  lw         $v1, 0x14($s0)
/* 37FB4 800477B4 14008294 */  lhu        $v0, 0x14($a0)
/* 37FB8 800477B8 00000000 */  nop
/* 37FBC 800477BC 000062A4 */  sh         $v0, 0x0($v1)
/* 37FC0 800477C0 1400038E */  lw         $v1, 0x14($s0)
/* 37FC4 800477C4 18008294 */  lhu        $v0, 0x18($a0)
/* 37FC8 800477C8 00000000 */  nop
/* 37FCC 800477CC 020062A4 */  sh         $v0, 0x2($v1)
/* 37FD0 800477D0 1400038E */  lw         $v1, 0x14($s0)
/* 37FD4 800477D4 1C008294 */  lhu        $v0, 0x1C($a0)
/* 37FD8 800477D8 00000000 */  nop
/* 37FDC 800477DC 040062A4 */  sh         $v0, 0x4($v1)
/* 37FE0 800477E0 1000A897 */  lhu        $t0, 0x10($sp)
/* 37FE4 800477E4 4000E38E */  lw         $v1, 0x40($s7)
/* 37FE8 800477E8 00140800 */  sll        $v0, $t0, 16
/* 37FEC 800477EC C3120200 */  sra        $v0, $v0, 11
/* 37FF0 800477F0 21206200 */  addu       $a0, $v1, $v0
/* 37FF4 800477F4 1400038E */  lw         $v1, 0x14($s0)
/* 37FF8 800477F8 14008294 */  lhu        $v0, 0x14($a0)
/* 37FFC 800477FC 00000000 */  nop
/* 38000 80047800 080062A4 */  sh         $v0, 0x8($v1)
/* 38004 80047804 1400038E */  lw         $v1, 0x14($s0)
/* 38008 80047808 18008294 */  lhu        $v0, 0x18($a0)
/* 3800C 8004780C 00000000 */  nop
/* 38010 80047810 0A0062A4 */  sh         $v0, 0xA($v1)
/* 38014 80047814 1400038E */  lw         $v1, 0x14($s0)
/* 38018 80047818 1C008294 */  lhu        $v0, 0x1C($a0)
/* 3801C 8004781C 00000000 */  nop
/* 38020 80047820 0C0062A4 */  sh         $v0, 0xC($v1)
/* 38024 80047824 0C1E0108 */  j          .L80047830
/* 38028 80047828 02000224 */   addiu     $v0, $zero, 0x2
.L8004782C:
/* 3802C 8004782C FFFF0224 */  addiu      $v0, $zero, -0x1
.L80047830:
/* 38030 80047830 120002A6 */  sh         $v0, 0x12($s0)
.L80047834:
/* 38034 80047834 1B2D010C */  jal        FX_InsertGeneralEffect
/* 38038 80047838 21200002 */   addu      $a0, $s0, $zero
/* 3803C 8004783C 21100002 */  addu       $v0, $s0, $zero
.L80047840:
/* 38040 80047840 3C00BF8F */  lw         $ra, 0x3C($sp)
/* 38044 80047844 3800BE8F */  lw         $fp, 0x38($sp)
/* 38048 80047848 3400B78F */  lw         $s7, 0x34($sp)
/* 3804C 8004784C 3000B68F */  lw         $s6, 0x30($sp)
/* 38050 80047850 2C00B58F */  lw         $s5, 0x2C($sp)
/* 38054 80047854 2800B48F */  lw         $s4, 0x28($sp)
/* 38058 80047858 2400B38F */  lw         $s3, 0x24($sp)
/* 3805C 8004785C 2000B28F */  lw         $s2, 0x20($sp)
/* 38060 80047860 1C00B18F */  lw         $s1, 0x1C($sp)
/* 38064 80047864 1800B08F */  lw         $s0, 0x18($sp)
/* 38068 80047868 0800E003 */  jr         $ra
/* 3806C 8004786C 4000BD27 */   addiu     $sp, $sp, 0x40
.size FX_StartRibbon, . - FX_StartRibbon
